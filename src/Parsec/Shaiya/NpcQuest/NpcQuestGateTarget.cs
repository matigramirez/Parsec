using Parsec.Common;
using Parsec.Serialization;
using Parsec.Shaiya.Common;
using Parsec.Shaiya.Core;

namespace Parsec.Shaiya.NpcQuest;

public class NpcQuestGateTarget : ISerializable
{
    public ushort MapId { get; set; }

    public Vector3 Position { get; set; } = new();

    public string TargetName { get; set; } = string.Empty;

    /// <summary>
    /// Teleporting gold cost
    /// </summary>
    public uint Cost { get; set; }

    public void Read(SBinaryReader binaryReader)
    {
        MapId = binaryReader.ReadUInt16();
        Position = binaryReader.Read<Vector3>();

        if (binaryReader.SerializationOptions.Episode < Episode.EP8)
        {
            TargetName = binaryReader.ReadString();
        }

        Cost = binaryReader.ReadUInt32();
    }

    public void Write(SBinaryWriter binaryWriter)
    {
        binaryWriter.Write(MapId);
        binaryWriter.Write(Position);

        if (binaryWriter.SerializationOptions.Episode < Episode.EP8)
        {
            binaryWriter.Write(TargetName, includeStringTerminator: false);
        }

        binaryWriter.Write(Cost);
    }
}
